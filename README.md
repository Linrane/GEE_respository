# 这是一条公告

这里我会放一些我常用的并且可运行的代码，并且会附带链接，可查看运行效果。以及随着后续的内容的更新，直接看可能会眼花缭乱，所以推荐你先看readme+搜索关键词即可。

目前AI技术很先进了，我们可以让AI生成和修改，但是我们最想要的还是一个完整的成果，可以被下载下来直接使用的。

毕竟AI生成还是需要进行一系列的操作的，以及操作还会污染你的代码。

本仓库提供一个范本为了让各位能直接运行，可以直接进行修改和使用，以及我会搜集一些好的不错的内容放上来，并且在这里进行更新的说明，并且引用的内容已经是网络上可查的并且公开的，如果有内容禁止发布到此平台和侵犯隐私权和著作权等情况请从主页邮箱联系并表明你的身份，说明我的仓库中哪一部分的代码不允许表达等，协商处理谢谢。

如果有好的想法和建议，以及批评，修改错误等都可以提出，方便大家共同学习，可以通过邮箱联系我成为共创，一起分享实用的代码。

注：本文所使用的assets和project都是出自于本地上传，所以你需要在如：“var roi = ee.FeatureCollection('projects/ee-linrane111/assets/eeds');”中进行修改，把引号内容的内容修改成你上传的内容即可。

# 1.监督分类下的土地利用覆盖

代码运行：https://code.earthengine.google.com/7c4b50ee54b787fc33d33a2632c88111

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界并可视化

2.加载、预处理 Landsat 8 表面反射率数据（去云、辐射定标）

3.加载 Google Dynamic World V1 土地覆盖数据作为参考标签

4.构建样本数据集（分层采样）并划分训练 / 验证集

5.使用随机森林算法训练分类器

6.评估分类精度（混淆矩阵、总体精度、Kappa 系数等）

7.对 Landsat 影像进行分类并可视化结果

8.将分类结果导出到 Google Drive
```

# 2.Lantsay8真彩影像加载（可添加下载）

代码运行：https://code.earthengine.google.com/0d63173a019bc5c460243ca35724e1ed

整体实现思路如下：

```
1.加载 Landsat 8 C02 T1_L2 级地表反射率影像集合

2.按 2023 全年时间范围、北京经纬度点空间范围、云量低于 10% 的条件筛选影像，并选取符合条件的第一景影像

3.配置真彩色可视化参数（红 / 绿 / 蓝波段组合、亮度范围、伽马校正），将地图视图居中到该影像并添加真彩色图层展示
```

# 3.哨兵一号监测洪水淹没区

代码运行：https://code.earthengine.google.com/dd7b66e827702f2a0a08c9f90741daa0

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界并可视化

2.加载哥白尼 S1 雷达影像集，筛选 VH 极化、IW 模式、升降轨数据

3.按 2021 年洪水期前后日期筛选影像，划分灾前、灾后数据集定义雷达影像单位转换（dB / 自然值）和 RefinedLee 斑点滤波函数

4.对灾前、灾后影像进行镶嵌、裁剪、滤波预处理

5.通过阈值法提取洪水淹没区和永久水体

6.可视化灾前 / 灾后影像、洪水淹没区、永久水体图层

7.计算并输出洪水淹没区面积（公顷）
```

# 4.GHSL 建成区面积分析导出

代码运行：https://code.earthengine.google.com/990d35ecabbf3a192f36fe17d2ad2f53

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界矢量数据并添加到地图可视化，将地图视图居中到研究区

2.加载 JRC/GHSL 100 米分辨率建成区影像集，筛选研究区范围内数据并仅保留建成区波段

3.配置可视化参数，选取影像集中最新年份的影像，裁剪后添加到地图展示

4.遍历影像集，按年份计算研究区内建成区面积（平方米、平方千米），处理空值并构建包含年份和面积信息的特征集合

5.基于特征集合创建柱状图，可视化展示各年份建成区面积变化

6.将包含年份和面积信息的特征集合导出为 CSV 文件到 Google Drive 指定文件夹

7.自动遍历影像集年份，批量创建导出任务，将各年份建成区影像裁剪后以 GeoTIFF 格式导出到 Google Drive 指定路径
```

# 5.逐年 NDWI 均值分析导出

代码运行：https://code.earthengine.google.com/fc15793846f923de26759d1344416984

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界矢量数据并添加到地图可视化，将地图视图居中到研究区

2.加载 Landsat 年度 NDWI 合成影像数据集

3.定义 2014-2024 年的年份范围并生成年份序列列表

4.遍历年份列表，筛选对应年份的 NDWI 影像并计算研究区内 NDWI 均值，构建包含年份和均值信息的特征集合

5.将 NDWI 均值特征集合转换为 FeatureCollection 并打印到控制台

6.基于特征集合创建折线图，可视化展示 2014-2024 年研究区年均 NDWI 变化趋势

7.遍历年份列表，批量创建导出任务，将每年 NDWI 均值影像裁剪后以 GeoTIFF 格式导出到 Google Drive 的 NDWI_Exports 文件夹
```

# 6.NDVI 时序分析

代码运行：https://code.earthengine.google.com/d84a5d42d164b6154d236fedf6d73078

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界矢量数据并添加到地图可视化，将地图视图居中到研究区

2.定义影像缩放因子还原函数，对 Landsat 光学波段和热波段进行辐射定标

3.定义放宽条件的去云掩膜函数，仅屏蔽高置信度云和云阴影，保留薄云等低影响像素

4.处理 2000-2011 年 Landsat 5 影像：按年份筛选影像，应用缩放还原和去云函数，计算 NDVI 并取年度中值，裁剪到研究区后添加年份属性

5.处理 2012 年 Landsat 7 影像：按相同流程（适配 L7 数据源）计算年度 NDVI 中值，裁剪到研究区并添加年份属性

6.处理 2013-2023 年 Landsat 8 影像：适配 L8 波段组合计算 NDVI，按相同流程生成年度 NDVI 中值影像，裁剪到研究区并添加年份属性

7.合并 L5、L7、L8 处理后的影像集合，形成 2000-2023 年连续的 NDVI 时序数据集

8.创建 NDVI 时序折线图，适配鄂尔多斯干旱区特征调整 Y 轴范围，添加线性趋势线并显示 R² 值，可视化展示 NDVI 年际变化趋势
```

# 7.LST 与 NDVI 相关性分析

代码运行：https://code.earthengine.google.com/d7da1ecdbf372b39690a48d95b07f171

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界矢量数据并添加到地图可视化，将地图视图居中到研究区

2.加载 2024 年 4-7 月 Landsat 8 影像集，筛选云量 < 10% 的影像并计算中值合成，裁剪到研究区

3.定义 NDVI 计算函数，基于 Landsat 8 B5、B4 波段计算归一化植被指数并添加为影像波段

4.定义地表发射率计算函数，基于 NDVI 值估算地表发射率并添加为影像波段

5.定义地表温度（LST）计算函数，将热红外波段 DN 值转换为亮温，结合发射率计算真实地表温度

6.依次执行 NDVI、发射率、LST 计算流程，生成包含多参数的影像并打印 LST 影像信息

7.计算研究区内 LST 的最小值、最大值、平均值，创建并配置统计面板展示这些结果

8.对 LST 和 NDVI 进行 1000 个像素的采样分析，计算二者皮尔逊相关系数并打印结果

9.基于采样数据创建散点图，可视化展示 LST 与 NDVI 的相关性并添加趋势线

10.定义 LST 和 NDVI 的可视化参数及图例创建函数，分别生成对应图例面板

11.创建地图切换下拉控件，实现 “选择地图”“地表温度”“植被指数” 图层切换，同步管理图例和统计面板的显示 / 隐藏

12.初始化地图控件，设置默认显示 “选择地图” 状态，仅展示研究区边界
```

# 8.16mFVC时空对比分析

代码运行：https://code.earthengine.google.com/2d13208e5027d18937fb115911e9da02

整体实现思路如下：

```
1.加载通辽研究区边界几何数据，设定 2015/2025 年 5-9 月时间范围和 16 米输出分辨率等基础参数

2.加载 Landsat 8/9 C02 T1_L2 影像集并合并，定义云雪掩膜函数，过滤云、卷云、雪像素后提取光学波段并归一化，同时计算 NDVI 并添加为波段

3.定义 FVC 计算核心函数：筛选指定时间范围的影像，计算 NDVI 最大值，通过 5%/95% 分位数确定裸地 / 植被 NDVI 阈值，基于阈值计算植被覆盖度（FVC）并限制取值范围 0-1

4.调用 FVC 计算函数，分别生成 2015 年和 2025 年通辽地区 NDVI 最大值影像和 FVC 影像

5.配置 NDVI 和 FVC 可视化参数，将通辽边界、2015/2025 年 NDVI 及 FVC 影像添加到地图并居中视图

6.批量创建导出任务，将 2015/2025 年的 FVC 和 NDVI 影像以 16 米分辨率、EPSG:4326 投影导出到 Google Drive 指定文件夹
```

# 9.30mFVC年度对比计算

代码运行：https://code.earthengine.google.com/6cbbb1c4eec7fbcacd307e08179e1a87

整体实现思路如下:

```
1.加载通辽研究区边界几何数据，将地图视图居中到研究区并添加边界可视化图层

2.定义 2015 年和 2025 年 6-8 月（植被生长季）的时间范围，聚焦植被覆盖稳定期

3.定义 Landsat 8 去云函数，屏蔽云、卷云像素，提取光学波段并归一化，基于 SR_B5/SR_B4 波段计算 NDVI 并添加为影像波段

4.定义年度数据处理函数：加载指定时间范围的 Landsat 8 影像，去云后提取 NDVI 波段，计算 NDVI 最大值合成影像，通过 5%/95% 分位数确定裸土 / 全植被 NDVI 阈值，基于像元二分模型计算 FVC 并限制取值范围 0-1

5.调用年度处理函数，分别生成 2015 年和 2025 年通辽地区 NDVI 最大值影像和 FVC 影像

6.配置 NDVI 和 FVC 可视化参数，将 2015/2025 年的 NDVI 及 FVC 影像添加到地图展示

7.创建导出任务，将 2015 年和 2025 年的 FVC 影像以 30 米分辨率、EPSG:4326 投影导出到 Google Drive 指定文件夹
```

# 10.10mNDVI年度导出

代码运行：https://code.earthengine.google.com/e2a00e29b9b484b5b606802d5e730411

整体实现思路如下：

```
1.加载鄂尔多斯研究区边界矢量数据，将地图视图居中到研究区

2.配置 NDVI 可视化参数，设定数值范围 0-0.8 及蓝 - 绿 - 红配色方案

3.定义哨兵 2 云掩膜函数，基于 QA60 波段屏蔽云、卷云像素

4.定义 NDVI 计算函数，基于 B8/B4 波段计算归一化植被指数，将值限制在 0-1 范围并添加为影像波段

5.加载 2016-2017 年哨兵 2 Harmonized 影像集，筛选云量 < 20% 的影像，应用云掩膜和 NDVI 计算函数后仅保留 NDVI 波段

6.生成 2015-2025 年年份序列，遍历年份筛选对应年度 NDVI 影像并计算最大值合成，添加年份和时间属性

7.将各年度 NDVI 最大值影像裁剪到研究区后添加到地图可视化

8.批量创建导出任务，将 2015-2025 年 NDVI 影像以 10 米分辨率、EPSG:4326 投影导出到 Google Drive 指定文件夹
```

# 11.LUCC样本数据

（注：从第十一个开始我会开始注明是个人编写还是从文章中拿过来用的，并且会附带好文章地址，请各位尊重原创！尊重别人的劳动成功）

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/SotWDGJAbNfgWVZzgK7l4g

代码运行：https://code.earthengine.google.com/45323fa628c4a9c35fae3e1e2d639182

整体实现思路如下：

```
1.加载 2018 年 JRC/LUCAS_HARMO 全球土地覆盖多边形要素数据集

2.配置可视化参数，设定数值显示范围为 35 到 60

3.对数据集中每个多边形要素进行 5000 米缓冲区处理，生成新的要素集合

4.创建浮点型空影像，将缓冲区要素的 GPS 纬度值绘制到影像上，并应用随机配色可视化

5.添加白色背景图层到地图，再添加带有可视化参数的纬度影像图层展示 LUCAS 多边形

6.添加原始 LUCAS 数据集图层并设置为默认隐藏，仅用于地图检查器查看

7.将地图中心定位到经纬度 (19.514, 51.82)，缩放级别设为 8
```

# 12.Sential2较好去云数据集示例

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/sCIY_kxpNVEBIj07_xbUrg

代码运行：https://code.earthengine.google.com/1f49de41a5d2aa0253068d876f48fc64

整体实现思路如下;

```
1.加载哨兵 2 SR Harmonized（L2A）影像集和 Google Cloud Score + 云评分影像集

2.定义感兴趣区（ROI）为经纬度 (-119.9087, 37.4159) 的点要素

3.设定云评分波段为 'cs_cdf'，云掩膜阈值为 0.60（高于该值判定为晴空）

4。筛选 2023 年 1-2 月 ROI 范围内的 S2 影像，关联 Cloud Score + 数据集并提取指定云评分波段

5.遍历影像集，基于云评分阈值掩膜掉云像素，仅保留晴空像素

6.对掩膜后的影像集计算中值合成，生成无云 / 少云的均值影像

7.配置 S2 真彩色可视化参数（B4/B3/B2 波段），将合成影像添加到地图展示

8.将地图中心定位到 ROI，缩放级别设为 11
```

# 13.L8影像轨道覆盖范围

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/qpaJ1fdtCs8iyDULBPk9ig

代码运行：https://code.earthengine.google.com/de3b74729979f4c0775ec772fb472cce

整体实现思路如下：

```
1.定义多边形研究区（AOI）的经纬度范围，将其赋值为 roi 并添加灰色边界图层到地图可视化

2.设置 2020 年为影像筛选的年份参数，加载 Landsat 8 C02 T1_L2 影像集，筛选研究区范围内 2020 年的影像

3.遍历影像集，提取每景影像的几何边界、WRS_PATH（轨道路径号）和 WRS_ROW（轨道行号），构建包含这些属性的要素集合

4.对要素集合按 WRS_PATH 和 WRS_ROW 去重，得到唯一的轨道覆盖范围要素集合

5.打印去重后要素集合的数量，配置红色轮廓的可视化样式，将轨道覆盖范围添加到地图展示
```

# 14.CASA模型计算NPP

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/v_hHJwkKYUprddyyR_RmDw

代码运行：https://code.earthengine.google.com/a59007b9b3b8fed513bbe4159ed65d93

整体实现思路如下：

```
1.定义 103-116°E、24-32°N 的矩形研究区，添加到地图可视化

2.加载 2001-2004 年 TerraClimate 气候数据集（降水、温度、短波辐射）和不同时段 MOD09GA/MYD09GA 影像集、MCD12Q1 土地覆盖数据集，定义投影裁剪函数统一重投影为 EPSG:4326 500 米分辨率并裁剪到研究区

3.处理气候数据：转换辐射 / 温度单位，计算月均温、热指数，添加年 / 月 / 年月属性

4.定义位运算提取函数，创建 MOD09GA 质量控制函数，屏蔽云、云影、卷云等异常像素，转换反射率单位

5.对 2002 年后 MOD09GA/MYD09GA 影像按时间匹配融合，计算 Terra/Aqua 同日影像反射率均值；2001-2002 年仅用 MOD09GA 数据，合并得到 2001-2004 年日均反射率数据集

6.处理土地覆盖数据：补充 2022 年数据，基于土地覆盖类型赋值 LUE、NDVI 极值、SR 极值

7.基于 MODIS 反射率计算 NDVI、NDWI、NDBI、NIRV、SR 等植被指数，按年份匹配融合 LUE、NDVI/SR 极值数据

8.按月份 / 年份合成数据：生成气候数据月 / 年合成、MODIS 指数月最大值合成，计算 7 月最优温度、年度热指数总和

9.计算水分胁迫（Wstress）、温度胁迫（Tstress1/Tstress2）指数，结合 FPAR（光合有效辐射吸收比例）、APAR（吸收的光合有效辐射）和 LUE，估算净初级生产力（NPP）

10.生成年度 NPP 合成数据，配置可视化参数并添加年度 NPP 图层到地图展示
```

# 15.用Python来提升GEE制图质量

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/Xu0C8n7VLTDVbF_NS-zZQA

代码运行：https://code.earthengine.google.com/c972be0f180ba6b2d4c8d1b120a8b4a8

（注，这个运行指的是GEE的代码运行，而第十五个代码当中利用Python优化的部分在第二部分，你需要在本地运行尝试

整体实现思路如下：

```
GEE:

1.加载示例森林生态区要素集合并筛选出森林要素，添加红色边界图层到地图可视化，将地图视图居中到森林区域

2.加载 2010-2020 年 MODIS MOD13A1 植被指数影像集，仅保留 NDVI 和 EVI 波段

3.定义日期格式化函数，将影像时间戳转换为 JavaScript Date 字符串格式

4.遍历植被指数影像集，对每景影像计算森林区域内 NDVI 和 EVI 的均值，提取影像日期并构建包含日期、EVI、NDVI 的行数据，生成包含行数据属性的要素集合

5.聚合要素集合的行数据属性，生成服务端二维数据表，定义包含日期（时间轴）、EVI（数据列 1）、NDVI（数据列 2）的列头

6.将列头与行数据拼接为完整的服务端数据表，通过 evaluate 方法传输到客户端

7.基于客户端数据表创建折线图，配置标题、坐标轴样式、线条宽度、配色等参数，打印图表到控制台展示森林区 EVI/NDVI 的时间变化趋势
```

```
Python:

1.定义经纬度范围的多边形森林研究区，添加红色边界图层到地图可视化并居中视图

2.加载 2010-2020 年 MODIS MOD13A1 影像集，筛选并仅保留 NDVI、EVI 波段

3.定义日期格式化函数，提取影像时间戳（毫秒级）；定义值提取函数，计算研究区内 NDVI/EVI 均值，构建包含时间戳、EVI、NDVI 的行数据，生成要素集合

4.输出要素集合数量，聚合行数据生成服务端二维数组，通过 getInfo () 转换为客户端数据

5.将客户端数据转换为 Pandas DataFrame，定义列名为 Date、EVI、NDVI

6.将时间戳转换为标准日期格式，使用 Matplotlib 创建 12×6 英寸折线图

7.绘制 EVI（蓝色）、NDVI（绿色）时序折线，配置标题、坐标轴标签（Times New Roman 字体）

8.美化图表：调整刻度字体大小、添加图例（左上）、网格（透明度 0.5），优化布局并显示图表
```

# 16.最新版（2024）CLCD

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/uRmT5aO6vB9LXqCmp2eFGQ

代码运行：https://code.earthengine.google.com/c8b7f8c215b3ef79c704bf05e32b4fcc

整体实现思路：这个就不用写了，因为本来就是一个数据集，直接用就行了

# 17.GEE实现撂荒地时空监测及多时相分类产品时空一致性检验

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/3Msz67-wFlXZUfnfd67KlA

代码运行：https://code.earthengine.google.com/a1494d94de6417bc41d87b5c5e4b91ea

（提醒：别忘了自己添加数据产品，这些代码基本上只要涉及到的都要自己往上加）

整体实现思路：

```
1.将研究区 AOI 赋值为 roi，添加灰色边界图层到地图并命名为 studyArea

2.加载指定路径下的土地利用影像集，调用自定义模块函数组装影像集

3.遍历影像集，掩膜掉值≤0 的像素，筛选出值 < 2 的像素，生成裁剪后的影像集合

4.将裁剪后的影像集转换为列表，生成 0 到影像数量 - 1 的序号序列并遍历：

5.对每个序号，获取前、中、后位置的影像并转换为浮点型

6.堆叠三张影像并计算众数，生成时序一致性校正后的影像列表

7.将校正后的影像列表转为多波段影像并添加到地图可视化

8.设定序列长度为 7，按滑动窗口方式截取多波段影像的 7 个连续波段，重命名后生成影像列表

9.创建权重模板数组并转换为二维数组，与滑动窗口影像进行矩阵乘法运算，生成检测结果影像

10.将检测结果影像展平为单波段集合，遍历每个波段筛选值等于 1100000 的像素（弃耕标识）

11.为弃耕像素赋值对应年份（1992 + 序号），生成包含弃耕标识和弃耕年份的影像集合

12.计算弃耕年份的最小值（最早弃耕年份）和弃耕标识的总和（弃耕次数），分别添加随机配色图层到地图展示
```

# 18.重心时序分析

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/p1-RPvNC75EOz1ckoXRqSg

代码运行：https://code.earthengine.google.com/dcd268e864ca4f0e985299e0b10c8ee9

整体实现思路：

```
1.加载黑龙江省边界要素集合并赋值为 roi，添加灰色边界图层到地图可视化并居中视图

2.定义两个随机生成 16 进制颜色码的函数，用于后续图层配色

3.定义重心计算函数：为水稻分布影像添加经纬度波段并裁剪到研究区，掩膜出水稻分布区域（值 = 1），计算水稻区经度 / 纬度均值，生成重心点要素

4.循环遍历 1990-2021 年（步长 5 年）：
  加载对应年份的黑龙江水稻分布影像并命名为 riceMap
  调用重心计算函数，生成 500 米分辨率下的水稻分布重心点
  生成随机颜色，将重心点以该颜色添加到地图（默认隐藏）
  创建导出任务，将重心点要素以 SHP 格式导出到 Google Drive 的 A_PSPR 文件夹
  提取重心点坐标并添加到时序坐标列表

5.基于时序重心坐标列表创建线要素，添加到地图可视化

6.创建导出任务，将重心时序线要素以 SHP 格式导出到 Google Drive 的 A_PSPR 文件夹
```

# 19.利用自动生成少量但具有代表性样本和自适应策略的农作物制图研究

本代码为文章引用，原文章地址为：https://mp.weixin.qq.com/s/BmVBQarkxGD-DHnZVDE56w

代码运行：https://code.earthengine.google.com/00816de21d886f9fad11f3b815aaf9ac

整体实现思路：

```
1.将研究区 AOI 赋值为 roi，添加灰色边界图层到地图可视化并居中（缩放级别 5）

2.加载 2018-2019 年 USDA/NASS/CDL 作物覆盖数据集，提取 2018 年影像并添加到地图展示

3.计算研究区边界的经纬度极值，按 15 等分设置经纬度间隔，调用格网生成函数创建规则格网，筛选研究区内格网并添加橙色格网图层到地图

4.提取第 115 个格网作为子研究区（roi1），添加红色边界图层到地图

5.加载 2018-2020 年 CDL 数据，筛选玉米分布区域（值 = 1），计算三年玉米分布叠加值（0/1/2/3），添加随机配色图层（默认隐藏）

6.调用分层采样函数，在 roi1 内分别采集 500 个玉米样本（三年均为玉米）和非玉米样本（三年均非玉米），添加蓝 / 绿色图层并为样本添加 landcover 属性（1/0）

7.加载 2017 年 4-12 月哨兵 2 Harmonized 影像集，计算逐月 NDVI 中值合成，生成 8 个月的 NDVI 时序多波段影像

8.基于 NDVI 多波段影像，在玉米 / 非玉米样本点提取 NDVI 值，生成包含时序 NDVI 的样本要素集合

9.计算玉米样本各月份 NDVI 的均值和标准差，生成均值 ± 标准差的阈值列表

10.遍历玉米样本，判断每个样本各月份 NDVI 是否在均值 ± 标准差范围内（通过乘积符号判断），生成 8 个 flag 属性

11.筛选所有 flag<0 的玉米样本（所有月份 NDVI 均在阈值范围内），添加黄色图层到地图展示

12.定义两个工具函数：分层采样函数（按影像掩膜生成指定数量的采样点）、格网生成函数（按经纬度间隔创建矩形格网要素集）
```

#20.
